{% extends 'budget/base.html' %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>

<script>
    window.onload = function(){
        var ctx = document.getElementById("myChart").getContext("2d");
        var interestRate = 0;
        const xLabelYear = function(year){ // create an array of years since u cant put js var into django template
            var years = []
            var year = year
            for (i=0;i< 50; i++){
                years.push(year)
                year++
            }
            return years;
        }
        const yCompoundInterest = function(interest){ // create an array of compounded savings since u cant put js var into django template
            var savingsInvestments = 0
            var compoundedSavings = []
            var finalinterest = (interest/100) + 1
            {% for i in expensename %}
                if('{{ i.category__name }}' == 'savings and investments'){
                    savingsInvestments = '{{ i.amount }}' 
                }
            {% endfor %}
            for (i=0;i< 50; i++){
                compoundedSavings.push(savingsInvestments)
                savingsInvestments *= finalinterest
            }
            return compoundedSavings;
        }
        const selectedChart = function(interestRate){   
            return new Chart(ctx, {
            type: 'line',
            data: {
                labels: xLabelYear('{{ today }}'),
                datasets: [{
                    label: ['interest rate','lol'],
                    data:
                          interestRate,
                        
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 99, 132, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1,
                    scales: {
                        xAxes: [{
                            type: 'time',
                            
                        }]
                    }
                },{
                    label: 'interestRate',
                    data:
                          yCompoundInterest(3),
                        
                    backgroundColor: [
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1,
                    scales: {
                        xAxes: [{
                            type: 'time',
                            
                        }]
                    }
                }]
                
            },
            
        });}
    var myChart2 = selectedChart(interestRate)
    
    // Create a function to store getelementid values?
    
    document.getElementById("interest").onchange = function getInterest(){
        var skillsSelect = document.getElementById("interest");
        var selectedText = skillsSelect.options[skillsSelect.selectedIndex].text;
        var compund = yCompoundInterest(selectedText)
        myChart = selectedChart(compund)
    }
    
    
}
    
    
</script>  
    
 </script>
<div class='container' height="500" width="500">  
        <div style="display: inline-block"><canvas id="myChart" height="1000" width="1000"></canvas></div>
        <div  class='input field'>
            <div class="modal-content">
                <form method='POST'>
                    {% csrf_token %}
                    <select id='interest' style="display:block;width:60px; margin-left: auto;" onchange="getInterest()">
                            <option> 1 %</option>
                            <option> 2 %</option>
                            <option> 3 %</option>
                            <option> 4 %</option>
                            <option> 5 %</option>
                            <option> 6 %</option>
                            <option> 7 %</option>
                            <option> 8 %</option>
                            <option> 9 %</option>
                            <option> 10 %</option>
                    </select>
                </form>
            </div>
        </div>
    </div> 
</div>
  
{% endblock %}